version: '3.8'

services:
  tiler:
    build:
      context: .
      dockerfile: Dockerfile
    image: crpi-1arm6bubvql3ps3r.cn-beijing.personal.cr.aliyuncs.com/xfw-images/x-tiler:latest
    container_name: tiler

    # 挂载卷
    volumes:
      # 配置文件
      - ./conf.toml:/app/conf.toml
      # GeoJSON 文件目录
      - ./geojson:/app/geojson
      # 输出目录（瓦片下载存储位置）
      - ./output:/app/output
      # 日志文件（如果需要持久化日志）
      - ./tiler.log:/app/tiler.log

    # 环境变量（可选）
    environment:
      - TZ=Asia/Shanghai

    # 资源限制（可选，根据需要调整）
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '2'
    #       memory: 2G
    #     reservations:
    #       cpus: '1'
    #       memory: 1G

    # 网络配置（如果应用有 web 服务）
    # ports:
    #   - "8080:8080"

    # 重启策略
    restart: unless-stopped

    # 自定义命令（可选，覆盖 Dockerfile 中的 CMD）
    # command: ["-c", "/app/conf.toml"]
